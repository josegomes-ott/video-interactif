<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vid√©o Interactive</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: black; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script>
        let videos = [];
        let currentVideo;
        let shaderGraphics;
        let touchX = 0, touchY = 0;
        let colorShift = 0;
        let distortion = 0;
        
        function preload() {
            videos.push(createVideo('video1.mp4', vidLoaded));
            videos.push(createVideo('video2.mp4', vidLoaded));
            videos.push(createVideo('video3.mp4', vidLoaded));
        }
        
        function setup() {
            createCanvas(windowWidth, windowHeight, WEBGL);
            shaderGraphics = createGraphics(width, height, WEBGL);
            shaderGraphics.noStroke();
            setupShader();
            
            currentVideo = random(videos);
            videos.forEach(vid => vid.hide());
            
            currentVideo.show();
            currentVideo.loop();
        }
        
        function draw() {
            shaderGraphics.shader(myShader);
            myShader.setUniform("u_texture", currentVideo);
            myShader.setUniform("u_time", millis() / 1000);
            myShader.setUniform("u_touch", [touchX / width, touchY / height]);
            myShader.setUniform("u_colorShift", colorShift);
            myShader.setUniform("u_distortion", distortion);
            
            shaderGraphics.rect(-1, -1, 2, 2);
            image(shaderGraphics, -width / 2, -height / 2, width, height);
        }
        
        function touchMoved() {
            touchX = mouseX;
            touchY = mouseY;
            colorShift = sin(frameCount * 0.1) * 0.5;
            distortion = cos(frameCount * 0.1) * 0.2;
            
            if (random() > 0.95) {
                switchVideo();
            }
        }
        
        function switchVideo() {
            currentVideo.hide();
            currentVideo.stop();
            
            currentVideo = random(videos);
            currentVideo.show();
            currentVideo.loop();
        }
        
        function setupShader() {
            myShader = shaderGraphics.createShader(
                `precision mediump float;
                varying vec2 vTexCoord;
                uniform sampler2D u_texture;
                uniform float u_time;
                uniform vec2 u_touch;
                uniform float u_colorShift;
                uniform float u_distortion;
                
                void main() {
                    vec2 uv = vTexCoord;
                    uv.x += sin(uv.y * 10.0 + u_time) * u_distortion;
                    uv.y += cos(uv.x * 10.0 + u_time) * u_distortion;
                    
                    vec4 tex = texture2D(u_texture, uv);
                    tex.rgb *= vec3(1.0 + u_colorShift, 0.8 + sin(u_time) * 0.2, 0.8 + cos(u_time) * 0.2);
                    gl_FragColor = tex;
                }`
            );
        }
        
        function vidLoaded() {
            this.volume(0);
            this.hide();
            this.play();
        }
    </script>
</body>
</html>
